#!/bin/sh

set -x

cd `dirname $(readlink -f $0)`

echo : $SSH_ORIGINAL_COMMAND
echo $*

case $1 in
	kieran|kbingham)
		echo "Welcome Admin"
		ADMIN=true
		;;
	*)
		echo "Unregistered user"
		;;
esac

case $SSH_ORIGINAL_COMMAND in
	shell)
		if [ -z ${ADMIN+x} ];
			then echo "You are not an admin";
		else
			bash;
		fi;
		;;
	upgrade)
		git fetch origin
		git reset --hard origin/master
		./update-ssh-keys
		;;
	serial*)
		echo "./$SSH_ORIGINAL_COMMAND"
		./$SSH_ORIGINAL_COMMAND
		;;
	help)
		echo "Use the force, Luke ..."
		;;
	*)
		echo "Unknown command $SSH_ORIGINAL_COMMAND"
		;;
esac

